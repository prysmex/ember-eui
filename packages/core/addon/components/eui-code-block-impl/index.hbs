{{#let
  (class-names
    "euiCodeBlock__pre"
    (if (eq this.whiteSpace "pre") "euiCodeBlock__pre--whiteSpacePre")
    (if (eq this.whiteSpace "pre-wrap") "euiCodeBlock__pre--whiteSpacePreWrap")
  )
  (class-names "euiCodeBlock__code" @language)
  (class-names
    "euiCodeBlock"
    (if this.transparentBackground "euiCodeBlock--transparentBackground")
    (if @inline "euiCodeBlock--inline")
    (if (or @isCopyable @overflowHeight) "euiCodeBlock--hasControls")
    componentName="EuiCodeBlockImpl"
    paddingSize=this.paddingSize
    fontSize=this.fontSize
  )
  as |preClasses codeClasses classes|
}}
  {{#if @inline}}
    {{#if this.isPortalTargetReady}}
      {{#in-element this.codeTarget}}
        {{yield}}
      {{/in-element}}
      <span
        class={{classes}}
        {{style (if @overflowHeight (hash maxHeight=@overflowHeight))}}
      ><code
          {{did-insert (set this "code")}}
          class={{codeClasses}}
        ></code></span>
    {{/if}}
  {{else}}
    {{! Not inline }}
    {{#if this.isPortalTargetReady}}
      {{#in-element this.codeTarget}}
        {{yield}}
      {{/in-element}}
      <EuiInnerText @fallback="" as |setRef innerText|>
        <div
          class={{classes}}
          {{style (if @overflowHeight (hash maxHeight=@overflowHeight))}}
        >
          <pre
            {{did-insert setRef}}
            class={{preClasses}}
            {{style (if @overflowHeight (hash maxHeight=@overflowHeight))}}
          ><code
              {{did-insert (set this "code")}}
              class={{codeClasses}}
            ></code></pre>

          <EuiCodeBlockImpl::CodeBlockControls
            @innerText={{innerText}}
            @isCopyable={{@isCopyable}}
            @overflowHeight={{@overflowHeight}}
            @toggleFullScreen={{set this "isFullScreen" (not this.isFullScreen)}}
            @isFullScreen={{this.isFullScreen}}
          />

          {{#if this.isFullScreen}}
            <EuiOverlayMask>
              <div
                {{focus-trap
                  isActive=true
                  focusTrapOptions=(hash
                    clickOutsideDeactivates=true returnFocusOnDeactivate=true
                  )
                }}
              >
                <div
                  class={{class-names
                    "euiCodeBlock euiCodeBlock-paddingLarge euiCodeBlock-isFullScreen"
                    fontSize=this.fontSize
                    componentName="EuiCodeBlockImpl"
                  }}
                >
                  <pre class={{preClasses}}>
                    {{!template-lint-disable}}
                    <code
                      {{did-insert
                        (queue (set this "codeFullScreen") this.update)
                      }}
                      {{will-destroy (set this "codeFullScreen" null)}}
                      {{did-update this.update @language}}
                      class={{codeClasses}}
                      tabIndex={{0}}
                      tabIndex={{0}}
                      {{on "keydown" this.onKeyDown}}
                    ></code>
                    {{!template-lint-enable}}
                  </pre>
                  <EuiCodeBlockImpl::CodeBlockControls
                    @innerText={{innerText}}
                    @isCopyable={{@isCopyable}}
                    @overflowHeight={{@overflowHeight}}
                    @toggleFullScreen={{set
                      this
                      "isFullScreen"
                      (not this.isFullScreen)
                    }}
                    @isFullScreen={{this.isFullScreen}}
                  />
                </div>
              </div>
            </EuiOverlayMask>
          {{/if}}
        </div>
      </EuiInnerText>
    {{/if}}
  {{/if}}
{{/let}}